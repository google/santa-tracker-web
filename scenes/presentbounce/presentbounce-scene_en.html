<!--
Copyright 2015 Google Inc. All rights reserved.

Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at

      http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software distributed
under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
CONDITIONS OF ANY KIND, either express or implied. See the License for the
specific language governing permissions and limitations under the License.
-->
<link rel="import" href="../scene-behavior.html">

<script src="../shared/js/startbutton.js"></script>
<script src="presentbounce-scene.min.js"></script>

<!-- TODO(samthor): Upgrade styling for Polymer 1+ (#1165) -->
<link rel="stylesheet" href="presentbounce-scene.css" />

<!--
presentbounce scene.
-->
<dom-module id="presentbounce-scene">
<template>
  <div id="module-presentbounce">
    <div class="presentbounce">
      <div class="bg">
        <div class="wall-decoration wall-decoration--horizontal">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2000 292.5"><path fill="none" stroke="#34AAE1" stroke-width="5" stroke-miterlimit="10" d="M2000 24.4h-943.2c-2.8 0-5 2.2-5 5v106.3"/><path fill="none" stroke="#34AAE1" stroke-width="5" stroke-miterlimit="10" d="M2000 15h-943.6c-7.7 0-14 6.3-14 14v106.7"/><path fill="none" stroke="#34AAE1" stroke-width="5" stroke-miterlimit="10" d="M2000 5.6h-943.9c-12.7 0-23 10.3-23 23l-.1 107.2"/><path fill="#34AAE1" d="M1027.4 49.1h30v8h-30zM1081.4 0h8v30h-8zM1341.7 0h8v30h-8zM1601.9 0h8v30h-8zM1862.1 0h8v30h-8z"/><path fill="none" stroke="#34AAE1" stroke-width="5" stroke-miterlimit="10" d="M0 268.1h1028c2.8 0 5-2.2 5-5V135.7"/><path fill="none" stroke="#34AAE1" stroke-width="5" stroke-miterlimit="10" d="M0 277.5h1028.4c7.7 0 14-6.3 14-14V135.7"/><path fill="none" stroke="#34AAE1" stroke-width="5" stroke-miterlimit="10" d="M0 286.9h1028.6c12.7 0 23-10.3 23-23l.1-128.2"/><path fill="#34AAE1" d="M1027.4 235.4h30v8h-30zM995.3 262.5h8v30h-8zM740.2 262.5h8v30h-8zM485.1 262.5h8v30h-8zM229.9 262.5h8v30h-8z"/></svg>
        </div>
        <div class="wall-decoration wall-decoration--top">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2000 622.9"><g fill="none" stroke="#34AAE1" stroke-width="5" stroke-miterlimit="10"><path d="M1539.3 374.4V0M1548.7 374.4V0M1558.1 374.4V0"/></g><path fill="#34AAE1" d="M1533.7 337.2h30v8h-30zM1533.7 179.2h30v8h-30z"/><g fill="none" stroke="#34AAE1" stroke-width="5" stroke-miterlimit="10"><path d="M1659.9 431.5H2000M1659.9 440.9H2000M1659.9 450.3H2000"/></g><path fill="#34AAE1" d="M1689.1 425.9h8v30h-8zM1839.1 425.9h8v30h-8z"/><g><path fill="none" stroke="#34AAE1" stroke-width="5" stroke-miterlimit="10" d="M898.7 0v406.7c0 2.8-2.2 5-5 5h-69.4"/><path fill="none" stroke="#34AAE1" stroke-width="5" stroke-miterlimit="10" d="M908.1 0v407.1c0 7.7-6.3 14-14 14h-69.8"/><path fill="none" stroke="#34AAE1" stroke-width="5" stroke-miterlimit="10" d="M917.5 0v407.4c0 12.7-10.3 23-23 23l-70.3.1"/><path fill="#34AAE1" d="M866 406.1h8v30h-8zM893.1 374.1h30v8h-30zM893.1 216.1h30v8h-30zM893.1 58.1h30v8h-30z"/><g><path fill="none" stroke="#34AAE1" stroke-width="5" stroke-miterlimit="10" d="M782.8 486.7v-51.2c0-2.8 2.2-5 5-5h36.5"/><path fill="none" stroke="#34AAE1" stroke-width="5" stroke-miterlimit="10" d="M773.4 486.7v-51.6c0-7.7 6.3-14 14-14h36.9"/><path fill="none" stroke="#34AAE1" stroke-width="5" stroke-miterlimit="10" d="M764 486.7v-51.9c0-12.7 10.3-23 23-23l37.3-.1"/><path fill="#34AAE1" d="M807.5 406.1h8v30h-8zM758.4 459.1h30v8h-30z"/></g><g><path fill="none" stroke="#34AAE1" stroke-width="5" stroke-miterlimit="10" d="M764 486.7v106.7c0 2.8-2.2 5-5 5H0"/><path fill="none" stroke="#34AAE1" stroke-width="5" stroke-miterlimit="10" d="M773.4 486.7v107.1c0 7.7-6.3 14-14 14H0"/><path fill="none" stroke="#34AAE1" stroke-width="5" stroke-miterlimit="10" d="M782.8 486.7v107.4c0 12.7-10.3 23-23 23L0 617.3"/><path fill="#34AAE1" d="M731.3 592.9h8v30h-8zM221 592.9h8v30h-8zM476.1 592.9h8v30h-8zM758.4 560.8h30v8h-30z"/></g></g><g><path fill="none" stroke="#34AAE1" stroke-width="2.55" stroke-miterlimit="10" d="M1469.8 418.2s14-12.1 34.4 0"/><path fill="#34AAE1" stroke="#34AAE1" stroke-width="2.55" stroke-miterlimit="10" d="M1466.3 431.5c4.3 7.2 12.2 12.1 21.2 12.1s16.9-4.9 21.2-12.1h-42.4z"/><path fill="none" stroke="#34AAE1" stroke-width="2.55" stroke-miterlimit="10" d="M1476.4 406.3l11.1 29.7M1531 418.2s14-12.1 34.4 0"/><path fill="#34AAE1" stroke="#34AAE1" stroke-width="2.55" stroke-miterlimit="10" d="M1527.5 431.5c4.3 7.2 12.2 12.1 21.2 12.1s16.9-4.9 21.2-12.1h-42.4z"/><path fill="none" stroke="#34AAE1" stroke-width="2.55" stroke-miterlimit="10" d="M1552.6 405.1l-5.2 31.3M1592.2 418.2s14-12.1 34.4 0"/><path fill="#34AAE1" stroke="#34AAE1" stroke-width="2.55" stroke-miterlimit="10" d="M1588.7 431.5c4.3 7.2 12.2 12.1 21.2 12.1s16.9-4.9 21.2-12.1h-42.4z"/><path fill="none" stroke="#34AAE1" stroke-width="2.55" stroke-miterlimit="10" d="M1615 405.3l-6.4 31.1M1469.8 477.7s14-12.1 34.4 0"/><path fill="#34AAE1" stroke="#34AAE1" stroke-width="2.55" stroke-miterlimit="10" d="M1466.3 491.1c4.3 7.2 12.2 12.1 21.2 12.1s16.9-4.9 21.2-12.1h-42.4z"/><path fill="none" stroke="#34AAE1" stroke-width="2.55" stroke-miterlimit="10" d="M1497.7 465.8l-10.9 29.8M1531 477.7s14-12.1 34.4 0"/><path fill="#34AAE1" stroke="#34AAE1" stroke-width="2.55" stroke-miterlimit="10" d="M1527.5 491.1c4.3 7.2 12.2 12.1 21.2 12.1s16.9-4.9 21.2-12.1h-42.4z"/><path fill="none" stroke="#34AAE1" stroke-width="2.55" stroke-miterlimit="10" d="M1545.1 464.1l3.3 31.6"/><path fill="#34AAE1" d="M1437.5 374.9v147.7h222.4V374.9h-222.4zm16.2 137.7c-3.4 0-6.2-2.8-6.2-6.2 0-3.4 2.8-6.2 6.2-6.2s6.2 2.8 6.2 6.2c-.1 3.5-2.8 6.2-6.2 6.2zm0-115.4c-3.4 0-6.2-2.8-6.2-6.2 0-3.4 2.8-6.2 6.2-6.2s6.2 2.8 6.2 6.2c-.1 3.5-2.8 6.2-6.2 6.2zm33.8 106c-13.6 0-24.7-11-24.7-24.7 0-13.6 11-24.7 24.7-24.7s24.7 11 24.7 24.7c-.1 13.6-11.1 24.7-24.7 24.7zm0-59.5c-13.6 0-24.7-11-24.7-24.7 0-13.6 11-24.7 24.7-24.7s24.7 11 24.7 24.7c-.1 13.6-11.1 24.7-24.7 24.7zm61.2 59.5c-13.6 0-24.7-11-24.7-24.7 0-13.6 11-24.7 24.7-24.7 13.6 0 24.7 11 24.7 24.7-.1 13.6-11.1 24.7-24.7 24.7zm0-59.5c-13.6 0-24.7-11-24.7-24.7 0-13.6 11-24.7 24.7-24.7 13.6 0 24.7 11 24.7 24.7-.1 13.6-11.1 24.7-24.7 24.7zm61.2 59.5c-13.6 0-24.7-11-24.7-24.7 0-13.6 11-24.7 24.7-24.7 13.6 0 24.7 11 24.7 24.7-.1 13.6-11.1 24.7-24.7 24.7zm0-59.5c-13.6 0-24.7-11-24.7-24.7 0-13.6 11-24.7 24.7-24.7 13.6 0 24.7 11 24.7 24.7-.1 13.6-11.1 24.7-24.7 24.7zm33.8 68.9c-3.4 0-6.2-2.8-6.2-6.2 0-3.4 2.8-6.2 6.2-6.2s6.2 2.8 6.2 6.2c0 3.5-2.8 6.2-6.2 6.2zm0-115.4c-3.4 0-6.2-2.8-6.2-6.2 0-3.4 2.8-6.2 6.2-6.2s6.2 2.8 6.2 6.2c0 3.5-2.8 6.2-6.2 6.2z"/><path fill="none" stroke="#34AAE1" stroke-width="2.55" stroke-miterlimit="10" d="M1592.2 477.7s14-12.1 34.4 0"/><path fill="#34AAE1" stroke="#34AAE1" stroke-width="2.55" stroke-miterlimit="10" d="M1588.7 491.1c4.3 7.2 12.2 12.1 21.2 12.1s16.9-4.9 21.2-12.1h-42.4z"/><path fill="none" stroke="#34AAE1" stroke-width="2.55" stroke-miterlimit="10" d="M1609 464.1l.1 31.7"/></g></svg>
        </div>
      </div>
      <div class="presentbounce-scene-viewport js-viewport">
        <div class="scene js-drop-target">
          <div class="levelboard"></div>
        </div>
      </div>
      <div class="gui">
        <div class="board board--game">
          <div class="js-drawer drawer">
            <div class="js-drawer-spring js-drawer-holder drawer__holder">
              <div class="js-drawer-counter js-drawer-holder drawer__counter">0</div>
            </div>
            <div class="js-drawer-belt js-drawer-holder drawer__holder">
              <div class="js-drawer-counter drawer__counter">0</div>
            </div>
            <div class="drawer__holder js-drawer-holder js-drawer-restart drawer__holder--restart">
              <button type="button" class="restart"></button>
            </div>
          </div>
          <div class="score">
            <div class="label"><i18n-msg msgid="score">PLACEHOLDER_i18n</i18n-msg></div>
            <div class="value">0</div>
          </div>
          <div class="level has-count">
            <div class="label"><i18n-msg msgid="level">PLACEHOLDER_i18n</i18n-msg></div>
            <div class="value"><span class="current-level">1</span><span class="dark-text">/10</span>
            </div>
            <div class="level-dots">
              <div class="level-item is-active">
                <div class="level-dot"></div>
                <div class="level-shadow"></div>
                <div class="level-number">1</div>
              </div>
              <div class="level-item">
                <div class="level-dot"></div>
                <div class="level-shadow"></div>
                <div class="level-number">2</div>
              </div>
              <div class="level-item">
                <div class="level-dot"></div>
                <div class="level-shadow"></div>
                <div class="level-number">3</div>
              </div>
              <div class="level-item">
                <div class="level-dot"></div>
                <div class="level-shadow"></div>
                <div class="level-number">4</div>
              </div>
              <div class="level-item">
                <div class="level-dot"></div>
                <div class="level-shadow"></div>
                <div class="level-number">5</div>
              </div>
              <div class="level-item">
                <div class="level-dot"></div>
                <div class="level-shadow"></div>
                <div class="level-number">6</div>
              </div>
              <div class="level-item">
                <div class="level-dot"></div>
                <div class="level-shadow"></div>
                <div class="level-number">7</div>
              </div>
              <div class="level-item">
                <div class="level-dot"></div>
                <div class="level-shadow"></div>
                <div class="level-number">8</div>
              </div>
              <div class="level-item">
                <div class="level-dot"></div>
                <div class="level-shadow"></div>
                <div class="level-number">9</div>
              </div>
              <div class="level-item">
                <div class="level-dot"></div>
                <div class="level-shadow"></div>
                <div class="level-number">10</div>
              </div>
            </div>
          </div>
          <div class="time">
            <div class="label"><i18n-msg msgid="time">PLACEHOLDER_i18n</i18n-msg></div>
            <div class="value"><span class="minutes dark-text">00</span><span class="dark-text"> : </span><span class="seconds">00</span></div>
          </div>
          <div class$="actions {{_computeTernary(hasClickedStart, '', 'is-collapsed')}}">
            <button type="button" class="restart"></button>
            <button type="button" class="pause"></button>
          </div>
        </div>
        <div class="levelup"></div>
        <div class="levelup--number"></div>
        <div class="gameover overlay">
          <div class="gameover-dialog overlay-dialog">
            <h2 class="gameover-title"><i18n-msg msgid="gameover">PLACEHOLDER_i18n</i18n-msg></h2>
            <div class="gameover-winner">
              <div class="gameover-score">
                <p class="gameover-label"><i18n-msg msgid="gameover_score">PLACEHOLDER_i18n</i18n-msg></p>
                <p class="gameover-number">0</p>
              </div>
            </div>
            <div class="gameover-buttons">
              <button type="button" class="Button Button--large gameover-play"><i18n-msg msgid="playagain">PLACEHOLDER_i18n</i18n-msg></button>
              <a href="{{pageUrl}}#village" class="Button Button--large"><i18n-msg msgid="gotovillage">PLACEHOLDER_i18n</i18n-msg></a>
              <div class="shareButtons"><a href="javascript:;" target="_blank" class="Button Button--small Button--noText shareButtons-google">Google+</a><a href="javascript:;" target="_blank" class="Button Button--small Button--noText shareButtons-facebook">Facebook</a><a href="javascript:;" target="_blank" class="Button Button--small Button--noText shareButtons-twitter">Twitter</a></div>
            </div>
          </div>
        </div>
        <div class="force-rotate landscape">
          <div class="force-rotate-graphic"></div>
          <div class="force-rotate-explanation"><i18n-msg msgid="tilt">PLACEHOLDER_i18n</i18n-msg></div>
        </div>
      </div>
    </div>
  </div>
</template>
<script>
(function() {
  Polymer({
    is: 'presentbounce-scene',
    behaviors: [window.SantaSceneBehavior],
    game: null,

    properties: {
      hasClickedStart: {
        type: Boolean,
        value: false
      },
    },

    onPreload: function() {
      this.preloadSounds('pb_load_sounds', 40);
      this.preloadImages([
        //'img/board.svg'
      ]);
    },

    onShow: function() {
      var module = this.$['module-presentbounce'];
      this.game = new scenes.presentbounce.Game(module);
      startButton(this, module, this.onClickStart_.bind(this));
    },

    onHide: function() {
      this.game.dispose();
      this.game = null;
      this.fire('sound-ambient', 'pb_end_game');
    },

    onClickStart_: function() {
      this.hasClickedStart = true;
      this.game.start();
    }
  });

})();
</script>
</dom-module>
