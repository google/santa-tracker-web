<link rel="import" href="../base-scene.html">
<link rel="import" href="../../elements/i18n-msg.html">
<link rel="import" href="../../components/google-apis/google-maps-api.html">
<link rel="import" href="../../components/core-a11y-keys/core-a11y-keys.html">

<link rel="import" href="dependencies.html">

<!--
Traditions scene.

@element traditions-scene
@extends base-scene
-->
<polymer-element name="traditions-scene" extends="base-scene">
<template>
  <link rel="stylesheet" href="traditions-scene.css" no-shim>
  <style>
  :host([mode="cast"]) .sceneboard,
  :host([mode="cast"]) #lessons-popup {
    display: none;
  }
  :host([mode="cast"]) .traditions-tradition {
    max-width: 50% !important;
    left: 150px !important;
  }
  :host([mode="cast"]) .traditions-tradition p {
    font-size: 3vh !important;
  }
  </style>

  <core-a11y-keys target="{{}}" keys="up down left right space enter" on-keys-pressed="{{arrowHandler}}"></core-a11y-keys>

  <div id="module-traditions">

    <div class="scene">
      <template if="{{santaApp}}">
        <google-maps-api version="3.exp" apiKey="{{santaApp.config.API_KEY}}"
                         clientId="{{santaApp.config.CLIENT_ID}}"
                         libraries="places,geometry"
                         language="{{santaApp.language}}"
                         on-api-load="{{mapsAPIReady}}"></google-maps-api>
      </template>
      <div id="traditions-map"></div>
      <div id="tradition-img"></div>
      <div class="traditions-all">
        <div class="traditions-tradition" data-id="us">
          <h2><i18n-msg msgid="us_country_name">PLACEHOLDER_i18n</i18n-msg></h2>
          <p><i18n-msg msgid="us_tradition">PLACEHOLDER_i18n</i18n-msg></p>
        </div>
        <div class="traditions-tradition" data-id="mx">
          <h2><i18n-msg msgid="mx_country_name">PLACEHOLDER_i18n</i18n-msg></h2>
          <p><i18n-msg msgid="mx_tradition">PLACEHOLDER_i18n</i18n-msg></p>
        </div>
        <div class="traditions-tradition" data-id="gt">
          <h2><i18n-msg msgid="gt_country_name">PLACEHOLDER_i18n</i18n-msg></h2>
          <p><i18n-msg msgid="gt_tradition">PLACEHOLDER_i18n</i18n-msg></p>
        </div>
        <div class="traditions-tradition" data-id="ca">
          <h2><i18n-msg msgid="ca_country_name">PLACEHOLDER_i18n</i18n-msg></h2>
          <p><i18n-msg msgid="ca_tradition">PLACEHOLDER_i18n</i18n-msg></p>
        </div>
        <div class="traditions-tradition" data-id="ar">
          <h2><i18n-msg msgid="ar_country_name">PLACEHOLDER_i18n</i18n-msg></h2>
          <p><i18n-msg msgid="ar_tradition">PLACEHOLDER_i18n</i18n-msg></p>
        </div>
        <div class="traditions-tradition" data-id="br">
          <h2><i18n-msg msgid="br_country_name">PLACEHOLDER_i18n</i18n-msg></h2>
          <p><i18n-msg msgid="br_tradition">PLACEHOLDER_i18n</i18n-msg></p>
        </div>
        <div class="traditions-tradition" data-id="is">
          <h2><i18n-msg msgid="is_country_name">PLACEHOLDER_i18n</i18n-msg></h2>
          <p><i18n-msg msgid="is_tradition">PLACEHOLDER_i18n</i18n-msg></p>
        </div>
        <div class="traditions-tradition" data-id="uk">
          <h2><i18n-msg msgid="uk_country_name">PLACEHOLDER_i18n</i18n-msg></h2>
          <p><i18n-msg msgid="uk_tradition">PLACEHOLDER_i18n</i18n-msg></p>
        </div>
        <div class="traditions-tradition" data-id="gh">
          <h2><i18n-msg msgid="gh_country_name">PLACEHOLDER_i18n</i18n-msg></h2>
          <p><i18n-msg msgid="gh_tradition">PLACEHOLDER_i18n</i18n-msg></p>
        </div>
        <div class="traditions-tradition" data-id="fr">
          <h2><i18n-msg msgid="fr_country_name">PLACEHOLDER_i18n</i18n-msg></h2>
          <p><i18n-msg msgid="fr_tradition">PLACEHOLDER_i18n</i18n-msg></p>
        </div>
        <div class="traditions-tradition" data-id="de">
          <h2><i18n-msg msgid="de_country_name">PLACEHOLDER_i18n</i18n-msg></h2>
          <p><i18n-msg msgid="de_tradition">PLACEHOLDER_i18n</i18n-msg></p>
        </div>
        <div class="traditions-tradition" data-id="gr">
          <h2><i18n-msg msgid="gr_country_name">PLACEHOLDER_i18n</i18n-msg></h2>
          <p><i18n-msg msgid="gr_tradition">PLACEHOLDER_i18n</i18n-msg></p>
        </div>
        <div class="traditions-tradition" data-id="kg">
          <h2><i18n-msg msgid="kg_country_name">PLACEHOLDER_i18n</i18n-msg></h2>
          <p><i18n-msg msgid="kg_tradition">PLACEHOLDER_i18n</i18n-msg></p>
        </div>
        <div class="traditions-tradition" data-id="ru">
          <h2><i18n-msg msgid="ru_country_name">PLACEHOLDER_i18n</i18n-msg></h2>
          <p><i18n-msg msgid="ru_tradition">PLACEHOLDER_i18n</i18n-msg></p>
        </div>
        <div class="traditions-tradition" data-id="ph">
          <h2><i18n-msg msgid="ph_country_name">PLACEHOLDER_i18n</i18n-msg></h2>
          <p><i18n-msg msgid="ph_tradition">PLACEHOLDER_i18n</i18n-msg></p>
        </div>
        <div class="traditions-tradition" data-id="au">
          <h2><i18n-msg msgid="au_country_name">PLACEHOLDER_i18n</i18n-msg></h2>
          <p><i18n-msg msgid="au_tradition">PLACEHOLDER_i18n</i18n-msg></p>
        </div>
        <div class="traditions-tradition" data-id="nz">
          <h2><i18n-msg msgid="nz_country_name">PLACEHOLDER_i18n</i18n-msg></h2>
          <p><i18n-msg msgid="nz_tradition">PLACEHOLDER_i18n</i18n-msg></p>
        </div>
      </div>
      <div id="lessons-popup" hidden>
        <p>K-12 teachers: <span id="teacher-elf"></span> Download lesson plans aligned with the Common Core <a href="{{pageUrl}}" on-click="{{toggleLessons}}">here</a></p>
      </div>
      <div id="lessons" hidden>
        <div id="lessons-inner">
          <a href="#" id="close-lessons" on-click="{{toggleLessons}}"></a>
          <ul>
            <li><a href="https://santatracker.google.com/lesson_plans/ST-Lesson_Plan-Grades_K-2.pdf" target="_blank" on-click="{{trackLessonPlan}}" data-grades="grades-k-2"><span class="crayon crayon-k-2"></span> Grades K-2</a></li>
            <li><a href="https://santatracker.google.com/lesson_plans/ST-Lesson_Plan-Grades_3-5.pdf" target="_blank" on-click="{{trackLessonPlan}}" data-grades="grades-3-5"><span class="crayon crayon-3-5"></span> Grades 3-5</a></li>
            <li><a href="https://santatracker.google.com/lesson_plans/ST-Lesson_Plan-Grades_6-8.pdf" target="_blank" on-click="{{trackLessonPlan}}" data-grades="grades-6-8"><span class="crayon crayon-6-8"></span> Grades 6-8</a></li>
            <li><a href="https://santatracker.google.com/lesson_plans/ST-Lesson_Plan-Grades_9-10.pdf" target="_blank" on-click="{{trackLessonPlan}}" data-grades="grades-9-10"><span class="crayon crayon-9-10"></span> Grades 9-10</a></li>
        </div>
      </div>
      <div class="sceneboard">
        <a id="global-back-to-village" href="{{pageUrl}}#village" class="back"><i18n-msg msgid="gotovillage">PLACEHOLDER_i18n</i18n-msg></a>
        <div class="sceneboard-back"></div>
        <div class="controls">
          <ul>
            <li><a href="#" id="traditions-world" on-click="{{showWorld}}"><i18n-msg msgid="traditions-world">PLACEHOLDER_i18n</i18n-msg></a></li>
            <li><a href="#" id="traditions-prev" on-click="{{prevCountry}}"><i18n-msg msgid="traditions-prev">PLACEHOLDER_i18n</i18n-msg></a></li>
            <li><a href="#" id="traditions-next" on-click="{{nextCountry}}"><i18n-msg msgid="traditions-next">PLACEHOLDER_i18n</i18n-msg></a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</template>
<script>
(function() {
  Polymer({
    componentDir: 'scenes/traditions/',
    traditions: null,
    shown: false,

    nextCountry: function(e) {
      e.preventDefault();
      this.traditions.nextCountry();
    },

    prevCountry: function(e) {
      e.preventDefault();
      this.traditions.prevCountry();
    },

    showWorld: function(e) {
      e.preventDefault();
      this.traditions.showWorld();
    },

    trackLessonPlan: function(e, detail, sender) {
     this.fire('analytics-track-event', {category: 'lessonPlanDownload', action: 'click',
         label: sender.getAttribute('data-grades')});
    },

    toggleLessons: function(e) {
      e.preventDefault();
      this.$['lessons'].hidden = !this.$['lessons'].hidden;
    },

    onPreload: function() {
      this.preloadImages([
        'img/ar.png',
        'img/de.png',
        'img/gt.png',
        'img/mx.png',
        'img/pins_small.png',
        'img/traditions_icon.svg',
        'img/au.png',
        'img/dk.png',
        'img/is.png',
        'img/nz.png',
        'img/pins_small_2x.png',
        'img/uk.png',
        'img/br.png',
        'img/fr.png',
        'img/kg.png',
        'img/ph.png',
        'img/right.svg',
        'img/us.png',
        'img/ca.png',
        'img/gh.png',
        'img/left.svg',
        'img/pins_large.png',
        'img/ru.png',
        'img/cl.png',
        'img/gr.png',
        'img/pins_large_2x.png',
        'img/smallglobe.svg',
        'img/close.svg',
        'img/crayon-3-5.svg',
        'img/crayon-6-8.svg',
        'img/crayon-9-10.svg',
        'img/crayon-k-2.svg'
      ]);
    },

    mapsAPIReady: function() {
      this.traditions = new Traditions(
          this.$['module-traditions'], this.componentDir);
      if (this.shown) {
        this.traditions.onShow();
      }
    },

    onShow: function() {
      this.shown = true;
      if (this.traditions) {
        this.traditions.onShow();
      }
    },

    onHide: function() {
      this.shown = false;
      if (this.traditions) {
        this.traditions.onHide();
      }
    },

    arrowHandler: function(e, detail, sender) {
      e.stopPropagation();

      switch (e.detail.key) {
        case 'up':
        case 'left':
          this.prevCountry(e);
          break;
        case 'down':
        case 'right':
        case 'enter':
          this.nextCountry(e);
          break;
        case 'space':
          this.showWorld(e);
          break;
      }
    }

  });

})();
</script>
</polymer-element>
